---
title: "Midterm1"
author: "Jose Silva-Fernandez"
output:
  pdf_document: default
  html_document: default
---


### Midterm 1

```{r}
library(tidyverse)
library(nycflights13)
```

```{r}
flights
help("flights")
```


### Question 1: Use filter() to find all flights that:
### A) Flew to San Francisco International Airport (SFO)
```{r}
filter(flights, dest == "SFO")
```


### B) Departs in summer (July, August, September).
```{r}
filter(flights, month == 7 | month == 8 | month == 9)
```


### C) Were operated by United Airline, and had departure delays that were 10 or more minutes.

```{r}
filter(flights, carrier == "AA" & dep_delay >= 10)
```


### D) Arrived more than two hours late, but did not have a late departure.
```{r}
filter(flights, arr_time > 120 & dep_delay == 0)
```


### Question 2: Use group_by() and summarise() to create a data frame with the following columns:
###   Count of the number of flights for each carrier
###   Mean arrival delay for each carrier
###   Mean departure delay for each carrier

```{r}
flights %>%
  group_by(carrier) %>%
  summarise(
    count = n(),
    arr_delay_mean = mean(arr_delay, na.rm = TRUE),
    dep_delay_mean = mean(dep_delay, na.rm = TRUE)
  )
```

### Question 3: Refer to the data frame you created in Question 2 that contained the mean arrival and mean delay times for each carrier. Recreate the R code necessary to make the graph below. Also, write a few sentences interpreting this graph. Hint: geom_label() or geom_text() can be used to label each point with the carrier name (See https://ggplot2.tidyverse.org/reference/geom_text.html)

```{r}
flights2 <- flights %>%
  group_by(carrier) %>%
  summarise(
    count = n(),
    arr_delay_mean = mean(arr_delay, na.rm = TRUE),
    dep_delay_mean = mean(dep_delay, na.rm = TRUE)
  )
```
```{r}
ggplot(flights2, aes(x = dep_delay_mean, y = arr_delay_mean, label = carrier)) +
  geom_point() + 
  geom_label() + 
  xlab("Mean Departure Delay") + 
  ylab("Mean Arrival Delay")
```

#### There seems to be a linear, positive relationship between mean departure delay and mean arrival delay. As the mean departure delay increases, the mean arrival delay will also increase which makes sense because if you leave late, then you will arrive late.


### Question 4: For each carrier, compute the proportion of flights that were over 20 minutes late (i.e., had an arrival delay that was over 20 minutes). Which carrier had the largest proportion of arrival delays that were over 20 minutes?

```{r}
flights %>%
  group_by(carrier)%>%
  summarise(
    count = n(),
    arr_delay_prop = mean(arr_delay > 20, na.rm = TRUE)
  ) %>%
  arrange(desc(arr_delay_prop))
```

#### The largest proportion of arrival delays that was over 20 minutes is carrier F9 which is Frontier Flight.







